{% extends '::base.html.twig' %}

{% block body %}
	{% for task in tasks %}
		<div class="panel panel-default" id="task{{ task.id }}">
			<div class="panel-heading">
				<h3 class="panel-title">
					{{ task.title }}
					<span class="glyphicon glyphicon-trash pull-right no-display" id="delete{{ task.id }}"></span>
				</h3>
			</div>
			<div class="panel-body">
				{{ task.description }}
			</div>
			{% if task.dueDate %}
				<div class="panel-footer">
					{{ task.dueDate|date('d-m-Y h:i') }}
				</div>
			{% endif %}
		</div>

		<script type="text/javascript">
			$('#delete{{ task.id }}').click(function() {
				$.ajax({
					url: '{{ path("supprimer_tache", {"id" : task.id}) }}',
					dataType: 'json',
					success: function(data)
					{
						$('#task{{ task.id }}').animate({ height: 0, opacity: 0, margin: 0 }, 'slow');
						$.each(data['counter'],function(key, value) {
							$('#badge'+key).html(value);
						});
					}
		        });
			})
		</script>
	{% endfor %}
{% endblock %}

{% block javascripts %}
	<script type="text/javascript">
		$(function() {
			$('#deleteTasks').click(function() {
				$('.glyphicon-trash').fadeIn();
			})
		});
	</script>
{% endblock %}